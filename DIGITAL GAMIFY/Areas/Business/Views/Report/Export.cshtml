@{
    ViewBag.Title = "Export";
    Layout = "~/Areas/Business/Views/Shared/_LayoutBusiness.cshtml";
}


@*<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.6/jspdf.plugin.autotable.min.js"></script>
    <style>
        th, td {
            text - align: center;
            border: 1 px solid black;
            border - collapse: collapse;
        }
    </style>
    <center>
        <h2>TOTAL MARKS OF STUDENTS</h2>
        <br />
        <table id="simple_table" class="hide">
            <tr>
                <th>Roll No.</th>
                <th>Name</th>
                <th>Marks</th>
            </tr>
            <tr>
                <td>1</td>
                <td>Anna</td>
                <td>85</td>
            </tr>
            <tr>
                <td>2</td>
                <td>Bhavesh</td>
                <td>72</td>
            </tr>
            <tr>
                <td>3</td>
                <td>Sandhya</td>
                <td>63</td>
            </tr>
            <tr>
                <td>4</td>
                <td>Rohan</td>
                <td>90</td>
            </tr>
            <tr>
                <td>5</td>
                <td>Leena</td>
                <td>82</td>
            </tr>
            <tr>
                <td>6</td>
                <td>Nayan</td>
                <td>56</td>
            </tr>
        </table>
        <br />
        <input type="button" onclick="generate()" value="Export To PDF" />
    </center>
    <script type="text/javascript">
        function generate() {
            var doc = new jsPDF('p', 'pt', 'letter');
            var htmlstring = '';
            var tempVarToCheckPageHeight = 0;
            var pageHeight = 0;
            pageHeight = doc.internal.pageSize.height;
            specialElementHandlers = {
                // element with id of "bypass" - jQuery style selector
                '#bypassme': function (element, renderer) {
                    // true = "handled elsewhere, bypass text extraction"
                    return true
                }
            };
            margins = {
                top: 150,
                bottom: 60,
                left: 40,
                right: 40,
                width: 600
            };
            var y = 20;
            doc.setLineWidth(2);
            doc.text(200, y = y + 30, "TOTAL NUMBER OF WINNERS");
            doc.autoTable({
                html: '#simple_table',
                startY: 70,
                theme: 'grid',
                columnStyles: {
                    0: {
                        cellWidth: 180,
                    },
                    1: {
                        cellWidth: 180,
                    },
                    2: {
                        cellWidth: 180,
                    }
                },
                styles: {
                    minCellHeight: 40
                }
            })
            doc.save('SurveyPrizes.pdf');
        }
    </script>*@



@*<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>jQuery TableHTMLExport Plugin Examples</title>
    <link href="https://www.jqueryscript.net/css/jquerysctipttop.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/4.1.3/minty/bootstrap.min.css">
    <link href="toast.css" rel="stylesheet">
    <style>
        body {
            background-color: #fafafa;
        }

        .container {
            margin: 150px auto;
        }
    </style>
    <div class="vd_content-wrapper">
        <div class="vd_container">
            <div class="vd_content clearfix">
                <div id="jquery-script-menu">
                    <div class="jquery-script-center">
                        <ul>
                            <li><a href="https://www.jqueryscript.net/table/export-table-json-csv-txt-pdf.html">Download This Plugin</a></li>
                            <li><a href="https://www.jqueryscript.net/">Back To jQueryScript.Net</a></li>
                        </ul><div id="carbon-block"></div>
                        <div class="jquery-script-ads">
                            <script type="text/javascript">
    <!--
    google_ad_client = "ca-pub-2783044520727903";
    /* jQuery_demo */
    google_ad_slot = "2780937993";
    google_ad_width = 728;
    google_ad_height = 90;
    //-->
                            </script>
                            <script type="text/javascript"
                                    src="https://pagead2.googlesyndication.com/pagead/show_ads.js">
                            </script>
                        </div>
                        <div class="jquery-script-clear"></div>
                    </div>
                </div>
                <div class="container">
                    <h1>jQuery TableHTMLExport Plugin Examples</h1>
                    <table class="table" id="example">
                        <thead class="thead-dark">
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">First</th>
                                <th scope="col">Last</th>
                                <th scope="col">Handle</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th scope="row">1</th>
                                <td>Mark</td>
                                <td>Otto</td>
                                <td>mdo</td>
                            </tr>
                            <tr>
                                <th scope="row">2</th>
                                <td>Jacob</td>
                                <td>Thornton</td>
                                <td>fat</td>
                            </tr>
                            <tr>
                                <th scope="row">3</th>
                                <td>Larry</td>
                                <td>the Bird</td>
                                <td>twitter</td>
                            </tr>
                        </tbody>
                    </table>
                    <p class="lead"><button id="json" class="btn btn-primary">TO JSON</button> <button id="csv" class="btn btn-info">TO CSV</button>  <button id="pdf" class="btn btn-danger">TO PDF</button></p>
                </div>
                </div>
            </div>
        </div>
                <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.4.1/jspdf.min.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/2.3.5/jspdf.plugin.autotable.min.js"></script>
                <script src="~/Content/tableHTMLExport.js"></script>
                <script src="~/Content/autotable.js"></script>
                <script>
                    $('#json').on('click', function () {
                        $("#example").tableHTMLExport({ type: 'json', filename: 'sample.json' });
                    })
                    $('#csv').on('click', function () {
                        $("#example").tableHTMLExport({ type: 'csv', filename: 'sample.csv' });
                    })
                    $('#pdf').on('click', function () {
                        $("#example").tableHTMLExport({ type: 'pdf', filename: 'sample.pdf' });
                    })
                </script>
                <script>
                    try {
                        fetch(new Request("https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js", { method: 'HEAD', mode: 'no-cors' })).then(function (response) {
                            return true;
                        }).catch(function (e) {
                            var carbonScript = document.createElement("script");
                            carbonScript.src = "//cdn.carbonads.com/carbon.js?serve=CK7DKKQU&placement=wwwjqueryscriptnet";
                            carbonScript.id = "_carbonads_js";
                            document.getElementById("carbon-block").appendChild(carbonScript);
                        });
                    } catch (error) {
                        console.log(error);
                    }
                </script>
                <script type="text/javascript">

                    var _gaq = _gaq || [];
                    _gaq.push(['_setAccount', 'UA-36251023-1']);
                    _gaq.push(['_setDomainName', 'jqueryscript.net']);
                    _gaq.push(['_trackPageview']);

                    (function () {
                        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                    })();

                </script>*@

@*<div class="vd_content-wrapper">
    <div class="vd_container">
        <div class="vd_content clearfix">
            <table id="toExcel" class="uitable hide">
                <thead>
                    <tr>
                        <th>Kampanya Başlığı</th>
                        <th>Kampanya Türü</th>
                        <th>Kampanya Başlangıç</th>
                        <th>Kampanya Bitiş</th>
                        <th style="text-align: center">Aksiyonlar</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="Item in campaign.campaignList">
                        <td> Item.CampaignTitle </td>
                        <td> Item.CampaignHotelType </td>
                        <td> Item.CampaignHotelCheckInDate) </td>
                        <td>Item.CampaignHotelCheckOutDate</td>
                        <td style="text-align: center">
                            <button> Some Action </button>
                        </td>
                    </tr>
                </tbody>
            </table>

            <button onclick="exceller()">EXCEL</button>
            </div>
        </div>
    </div>

            <script>
                function exceller() {
                    var uri = 'data:application/vnd.ms-excel;base64,',
                      template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',
                      base64 = function (s) {
                          return window.btoa(unescape(encodeURIComponent(s)))
                      },
                      format = function (s, c) {
                          return s.replace(/{(\w+)}/g, function (m, p) {
                              return c[p];
                          })
                      }
                    var toExcel = document.getElementById("toExcel").innerHTML;
                    var ctx = {
                        worksheet: name || '',
                        table: toExcel
                    };
                    var link = document.createElement("a");
                    link.download = "export.xls";
                    link.href = uri + base64(format(template, ctx))
                    link.click();
                }

            </script>*@

<meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1">
<style>
    table {
        font-family: arial, sans-serif;
        border-collapse: collapse;
        width: 100%;
    }

    td, th {
        border: 1px solid #dddddd;
        text-align: left;
        padding: 8px;
    }

    tr:nth-child(even) {
        background-color: #dddddd;
    }
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="~/csvfiles/dist/table2csv.min.js"></script>
@*<script src="csvfiles/dist/table2csv.min.js"></script>*@
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" charset="utf-8"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script async defer src="https://buttons.github.io/buttons.js"></script>

<div class="vd_content-wrapper">
    <div class="vd_container">
        <div class="vd_content clearfix">
            <div class="d-flex flex-row justify-content-around align-items-center">
                <div>
                    <div id="tabContainer">
                        <table id="tab">
                            <tr class="row0">
                                <th class="col1">Company</th>
                                <th class="col2">Contact</th>
                                <th class="col3">Country</th>
                            </tr>
                            <tr class="row1">
                                <td class="col1">     Alfreds Futterkiste</td>
                                <td class="col2">		Maria Anders</td>
                                <td class="col3">Germany</td>
                            </tr>
                            <tr class="row2">
                                <td class="col1">Centro comercial Moctezuma 	</td>
                                <td class="col2">Francisco Chang    </td>
                                <td class="col3">Mexico	</td>
                            </tr>
                            <tr class="row3">
                                <td class="col1">Ernst Handel</td>
                                <td class="col2">Roland Mendel</td>
                                <td class="col3">Austria</td>
                            </tr>
                            <tr class="row4">
                                <td class="col1">Island Trading</td>
                                <td class="col2">Helen Bennett</td>
                                <td class="col3">UK</td>
                            </tr>
                            <tr class="row5">
                                <td class="col1">Laughing Bacchus Winecellars</td>
                                <td class="col2">Yoshi Tannamuri</td>
                                <td class="col3">Canada</td>
                            </tr>
                            <tr class="row6">
                                <td class="col1">Magazzini Alimentari Riuniti</td>
                                <td class="col2">Giovanni Rovelli</td>
                                <td class="col3">Italy</td>
                            </tr>
                            <tr class="row7">
                                <td class="col1">Seeverkehr</td>
                                <td class="col2">Johannes Gutenberg</td>
                                <td class="col3">München</td>
                            </tr>
                        </table>
                    </div>
                </div>
                <pre class="pre-scrollable">
                <code id="html"></code>
    </pre>
            </div>
            <p>Change values on the left to see the corresponding code, then press the button to see that code in action!</p>
            <div class="d-flex flex-row justify-content-around align-items-center">
                <div id="parameters">
                    <fieldset class="border p-3">
                        <legend class="w-auto">Action</legend>
                        <input type="radio" id="download-radio" name="action" value="download" />
                        <label for="download-radio">download</label>
                        <input type="radio" id="output-radio" name="action" value="output" checked />
                        <label for="output-radio">output</label>
                        <input type="radio" id="return-radio" name="action" value="return" />
                        <label for="return-radio">return</label>
                    </fieldset>
                    <fieldset class="border p-3" id="optionsControls">
                        <legend class="w-auto">Options</legend>
                        <label for="separator">separator</label>
                        <input type="text" id="separator" value="," />
                        <br />
                        <label for="newline">newline</label>
                        <input type="text" id="newline" value="\n" />
                        <br />
                        <label for="quoteFields">quoteFields</label>
                        <input type="checkbox" id="quoteFields" checked />
                        <br />
                        <label for="excludeColumns">excludeColumns</label>
                        <input type="text" id="excludeColumns" value="" />
                        <br />
                        <label for="excludeRows">excludeRows</label>
                        <input type="text" id="excludeRows" value="" />
                        <br />
                        <label for="trimContent">trimContent</label>
                        <input type="checkbox" id="trimContent" checked />
                        <br />
                        <label for="filename">filename</label>
                        <input type="text" id="filename" value="table.csv" />
                        <br />
                        <label for="appendTo">appendTo</label>
                        <input type="text" id="appendTo" value="#output" />
                    </fieldset>
                </div>
                <div>
                    <pre>
                    <code id="preview"></code>
        </pre>
                    <p>Press the button below to execute the code snippet above</p>
                    <div>
                        <button id="execute" onclick="executeCode()">Execute code</button>
                    </div>
                </div>
            </div>
            <fieldset id="output" class="p-2 border p-3">
                <legend class="w-auto">#output</legend>
            </fieldset>
            <button onclick="$('#output').find('pre').remove()" class="mt-1">Clear output</button>
            </div>
        </div>
    </div>
            <script>
                let html = $('#html');
                html.text($('#tabContainer').html());
                hljs.highlightBlock(html.get(0));

                //let options = {};
                let action;

                let options = {
                    "separator": ",",
                    "newline": "\n",
                    "quoteFields": true,
                    "excludeColumns": "",
                    "excludeRows": "",
                    "trimContent": true,
                    "filename": "table.csv"
                    //"appendTo": "#output"
                }

                function updateCode() {
                    options.separator = $("#separator").val().replace(/\\n/g, '\n').replace(/\\r/g, '\r').replace(/\\t/g, '\t');
                    options.newline = $("#newline").val().replace(/\\n/g, '\n').replace(/\\r/g, '\r').replace(/\\t/g, '\t');
                    options.quoteFields = $("#quoteFields").prop('checked');
                    options.excludeColumns = $("#excludeColumns").val();
                    options.excludeRows = $("#excludeRows").val();
                    options.trimContent = $("#trimContent").prop('checked');
                    options.filename = $("#filename").val();
                    options.appendTo = $("#appendTo").val();

                    action = $("input[type=radio][name=action]:checked").val();
                    let optionString = JSON.stringify(options, null, '\t');
                    let code = "let options = " + optionString + "\n\n" + "$('#tab').table2csv('" + action + "', options)";

                    let preview = $("#preview");
                    preview.text(code);
                    hljs.highlightBlock(preview.get(0))
                }

                $("#parameters").find(":input").change(updateCode).keyup(updateCode);

                updateCode();

                function executeCode() {

                    const retVal = $('#tab').table2csv('download', options);
                    if (action === "return") {
                        window.alert(retVal);
                    }
                }
            </script>




